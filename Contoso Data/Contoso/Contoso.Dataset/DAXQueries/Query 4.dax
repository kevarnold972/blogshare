DEFINE
	VAR __DS0Core = 
		SUMMARIZECOLUMNS(
			ROLLUPADDISSUBTOTAL('Product'[Color], "IsGrandTotalRowTotal"),
			"Total_Net_Price", 'Sales'[Total Net Price]
		)

	VAR __DS0PrimaryWindowed = 
		TOPN(502, __DS0Core, [IsGrandTotalRowTotal], 0, [Total_Net_Price], 0, 'Product'[Color], 1)

EVALUATE
	__DS0PrimaryWindowed

ORDER BY
	[IsGrandTotalRowTotal] DESC, [Total_Net_Price] DESC, 'Product'[Color]